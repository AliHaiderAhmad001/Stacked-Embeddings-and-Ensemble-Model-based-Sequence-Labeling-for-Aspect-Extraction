# -*- coding: utf-8 -*-
"""evaluation.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1cYGhZwhK5vEwmDMbYxcx8jtj5jJyIfK1
"""

def eval(model_path,data_path,label_path):
  model = load_model(model_path)
  stacked_test_emb=np.load(data_path)
  y_test=np.load(label_path)
  for i,x in enumerate(y_test):
    for j,c in enumerate(x):
      if c==2:
        y_test[i][j]=1
  metrics=Metrics(model,stacked_test_emb,y_test)
  print('F1-Score: ',metrics.reportAE()['F1-Score'])
  print(metrics.reportAE()['Classification Report'])
  print('--------------------------------------------------------------')
  print(metrics.print_cm())
  print('--------------------------------------------------------------')
  print(metrics.accuracy())
  print('\n')

# Re14-Eval
print('*******************************************************************')
print('Re14-Evaluation:')
print('*******************************************************************')
model_path='/content/drive/MyDrive/Colab Notebooks/AE/models/Re14Model/final_model'
data_path='/content/drive/MyDrive/Colab Notebooks/AE/embeddings/Re14DataEmb/test/test_data.npy'
label_path='/content/drive/MyDrive/Colab Notebooks/AE/embeddings/Re14Labels/test_labels.npy'
eval(model_path,data_path,label_path)

# Re16-Eval
print('*******************************************************************')
print('Re16-Evaluation:')
print('*******************************************************************')
model_path='/content/drive/MyDrive/Colab Notebooks/AE/models/Re16Model/final_model'
data_path='/content/drive/MyDrive/Colab Notebooks/AE/embeddings/Re16DataEmb/test/test_data.npy'
label_path='/content/drive/MyDrive/Colab Notebooks/AE/embeddings/Re16Labels/test_labels.npy'
eval(model_path,data_path,label_path)

# La14-Eval
print('*******************************************************************')
print('laptop14-Evaluation:')
print('*******************************************************************')
model_path='/content/drive/MyDrive/Colab Notebooks/AE/models/LabtopModel/final_model'
data_path='/content/drive/MyDrive/Colab Notebooks/AE/embeddings/LaptopDataEmb/test/test_data.npy'
label_path='/content/drive/MyDrive/Colab Notebooks/AE/embeddings/LaptopDataLabels/test_labels.npy'
eval(model_path,data_path,label_path)